version: "3.9"

services:
  mock-backend:
    build: .
    image: grandhotel-mock:dev
    container_name: grandhotel-mock
    ports:
      - "8081:8081"
    environment:
      - PORT=8081
      - MODE=${MODE:-mock}
      - STRICT_DOC=${STRICT_DOC:-false}
      - BACKEND_URL=${BACKEND_URL:-http://backend:8080}
    healthcheck:
      test: ["CMD-SHELL", "python -c \"import urllib.request; urllib.request.urlopen('http://127.0.0.1:8081/health')\" || exit 1"]
      interval: 30s
      timeout: 3s
      retries: 3
      start_period: 10s
    restart: unless-stopped
